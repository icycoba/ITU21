<!DOCTYPE html>
<html>
    <head>
        <title>Rezervační systém</title>
        <link href="../css/style.css" rel="stylesheet"/>
        <link href="../css/post-login.css" rel="stylesheet">
        <link href="../css/search.css" rel="stylesheet">
        <link rel="shortcut icon" type="image/x-icon" href="../images/logo.png">
    </head>
    
    <script type="text/javascript">
        function createXmlHttpRequestObject(){
            var request;

            try{
                request = new XMLHttpRequest();
            } catch(e){
                try{
                    request = new ActiveXObject("Microsoft.XMLHttp");
                } catch(e){
                    // ignore err
                }
            }

            if (!request){
                alert("Nepodařilo se vytvořit XMLHttpRequest.");
            } else{
                return request;
            }
        }
        
        function searchDisplay(){
            //alert("im in")
            try{
                
                var request = createXmlHttpRequestObject();

                request.open("GET", "http://localhost:8080/search", true);
                request.send(null);
                
                request.onreadystatechange = function(){
                    if((request.readyState == 4) && (request.status == 200)){
                        var response = JSON.parse(request.response)
                        var count = Object.keys(response).length;
                        
                        for(var i = 0; i <= count; i++){
                            var workingID = "item"+String(i)
                            var workingLink = "link" + String(i)
                            var workingImg = "img" + String(i)
                            var workingName = "name" + String(i)
                            var workingDesc = "desc" + String(i)
                            
                            document.getElementById(workingLink).href = "reservation_page-pre.html?serviceid=" + String(i);
                            document.getElementById(workingName).value = response[i].name;
                            document.getElementById(workingDesc).value = response[i].desc;
                            document.getElementById(workingImg).src = response[i].imagesrc;
                            document.getElementById(workingID).style = "display: grid";
                        }
                    }
                }
            }catch(e){
                alert(e.toString());
            }
            return false;
        }
    </script>
    
    <body>
        <div class="main">
            <div class="nav-links">
                <a href="index.html"><img src="../images/logo.png" id="logo"></a>
                <ul>
                    <li><a href="search-pre.html">Vyhledávání služby</a></li>
                    <li><a href="login_page.html">Přihlásit se</a></id></li>
                    <li><a href="learnmore-pre.html">Dozvedět se víc</a></li>
                </ul>
            </div>
            <div class="searchBar">
                <form>
                    <label for="searchBar">Zadejte službu:</label><br>
                    <input onkeyup="lookupFunc()" placeholder="Vyhledejte službu..." type="text" id="searchBar" name="searchBar">
                </form>
            </div>
            <div id="items" class="items">
                <div id="item0" style="display:none" class="item">
                    <a id="link0" href="reservation_page-pre.html"><img id="img0" src="../images/services/silueya_domu.jpg"></a>
                    <input id="name0" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc0" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item1" style="display:none" class="item">
                    <a id="link1" href="reservation_page-pre.html"><img id="img1" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name1" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc1" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item2" style="display:none" class="item">
                    <a id="link2" href="reservation_page-pre.html"><img id="img2" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name2" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc2" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item3" style="display:none" class="item">
                    <a id="link3" href="reservation_page-pre.html"><img id="img3" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name3" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc3" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item4" style="display:none" class="item">
                    <a id="link4" href="reservation_page-pre.html"><img id="img4" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name4" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc4" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item5" style="display:none" class="item">
                    <a id="link5" href="reservation_page-pre.html"><img id="img5" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name5" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc5" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item6" style="display:none" class="item">
                    <a id="link6" href="reservation_page-pre.html"><img id="img6" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name6" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc6" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item7" style="display:none" class="item">
                    <a id="link7" href="reservation_page-pre.html"><img id="img7" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name7" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc7" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item8" style="display:none" class="item">
                    <a id="link8" href="reservation_page-pre.html"><img id="img8" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name8" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc8" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>

                <div id="item9" style="display:none" class="item">
                    <a id="link9" href="reservation_page-pre.html"><img id="img9" src="../images/services/silueta_domu.jpg"></a>
                    <input id="name9" type="text" class="serviceName" name="serviceName" value="">
                    <input id="desc9" type="text" class="serviceDesc" name="serviceDesc" value="Temporary desc">
                </div>
            </div>
            <script type="text/javascript">
                searchDisplay();
            </script>
        </div>
    </body>

    <script type="text/javascript">
        function lookupFunc(){
            let input = document.getElementById('searchBar').value
            input = input.toLowerCase();
            
            let x = document.getElementsByClassName('serviceName');
            for (i = 0; i < x.length; i++){
                var tempitemID = "item"+i
                let xTemp = x[i].value.toLowerCase()
                
                if(xTemp.includes(input)){
                    if(input == "" && xTemp == ""){
                        continue;
                    }
                    document.getElementById(tempitemID).style = "display: grid";
                    
                } else{
                    document.getElementById(tempitemID).style = "display: none";
                }
            }
        }
    </script>
</html>